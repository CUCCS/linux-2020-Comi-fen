# 实验报告三

##### 实验内容：动手操作systemd，利用asciinema录屏，并完成自查清单

##### 实验结果：[命令篇](https://asciinema.org/a/MNRH4HNmZsYhc5nUiTRJZsBVv)	[实战篇](https://asciinema.org/a/Dxf6Ld15E6m6fxBj1IMZuYGYV)



## 自查清单

- 如何添加一个用户并使其具备sudo执行程序的权限？

  ```shell
  #添加用户  
  adduser username / useradd username
  
  #赋予sudo权限  
  sudo usermod -a username -G sudo #将用户添加到sudo组
  sudo adduser username sudo #直接赋予权限
  ```

- 如何将一个用户添加到一个用户组？

  ```shell
  sudo usermod -a username -G groupname
  ```

- 如何查看当前系统的分区表和文件系统详细信息？

  ```shell
  #查看分区表  
   sudo fdisk -l / sudo sdisk -l  
  
  #查看文件系统详细信息  
  df -a
  ```

- 如何实现开机自动挂载Virtualbox的共享目录分区？


  ```shell
  #在Virtualbox的共享文件夹中添加本地文件，设置自动挂载和固定分配
  
  #将sr0挂载到/media/cdrom目录
  sudo mount /dev/sr0 /media/cdrom
  
  #安装相关配置，进行升级
  sudo apt-get install build-essential gcc make perl dkms
  
  #安装增强功能并重启
  sudo /media/cdrom/./VBoxLinuxAdditions.run  
  reboot
  
  #检验是否安装成功  
  lsmod | grep vboxsf
  
  #创建共享目录  
  sudo mkdir /mnt/share
  
  #将本地文件夹挂载到指定目录  
  sudo mount -t vboxsf sharefilename/mnt/shard
  ```

  

- 基于LVM（逻辑分卷管理）的分区如何实现动态扩容和缩减容量？

  ```shell
  #动态扩容  
  lvextend -L +size /dev/dir
  #缩减容量  
  lvextend -L -size /dev/dir
  ```

  

- 如何通过systemd设置实现在网络连通时运行一个指定脚本，在网络断开时运行另一个脚本？

  打开所需脚本的配置文件，添加以下命令

  ```shell
   ExecStartPost=[MY_SATART_SCRIPT_PATH]  
   ExecStopPost=「MY_STOP_SCRIPT_PATH」  
  ```

  重新加载配置文件

  ```shell
  sudo systemctl daemon-reload
  ```

  以及重启网络服务

  ```shell
  sudo systemctl restart systemd-network.service
  ```

  

- 如何通过systemd设置实现一个脚本在任何情况下被杀死之后会立即重新启动？实现***杀不死\***？

  `systemctl cat 该脚本名`，编辑配置文件

  定义`[Service]`区块中的`Restart`字段，将其设为`always`